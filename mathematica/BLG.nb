(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26601,        892]
NotebookOptionsPosition[     25273,        843]
NotebookOutlinePosition[     25615,        858]
CellTagsIndexPosition[     25572,        855]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"eqn", " ", "=", " ", 
  RowBox[{
   RowBox[{
    SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], " ", "\[Equal]", " ", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{
      FractionBox[
       SuperscriptBox["g", "4"], "4"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], "k2", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["g", "2"], "+", 
         SuperscriptBox["u", "2"]}], ")"}]}]}], "]"}], "-", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      FractionBox[
       SuperscriptBox["g", "4"], "4"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], 
       RowBox[{"(", " ", 
        RowBox[{"k2", "-", 
         RowBox[{"n", " ", "\[Pi]"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["g", "2"], "+", 
         SuperscriptBox["u", "2"]}], ")"}]}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{"eqn", ",", "k2"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.732646635479753*^9, 3.7326466998519783`*^9}, {
  3.7326477392154074`*^9, 3.732647804505669*^9}, {3.732648523535384*^9, 
  3.732648530198371*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "\[Equal]", 
  RowBox[{
   SqrtBox[
    RowBox[{
     FractionBox[
      SuperscriptBox["g", "4"], "4"], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["g", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]}]], "-", 
   SqrtBox[
    RowBox[{
     FractionBox[
      SuperscriptBox["g", "4"], "4"], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"k2", "-", 
        RowBox[{"n", " ", "\[Pi]"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["g", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]}]]}]}]], "Output",
 CellChangeTimes->{{3.7326477620733433`*^9, 3.73264780491191*^9}, 
   3.732648530948515*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"k2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "+", 
        SuperscriptBox["u", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["g", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["g", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.7326477620733433`*^9, 3.73264780491191*^9}, 
   3.732648530979766*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqn2", "=", " ", 
   RowBox[{
    RowBox[{
     SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], " ", "\[Equal]", " ", 
    RowBox[{
     RowBox[{"Sqrt", "[", 
      RowBox[{
       FractionBox[
        SuperscriptBox["g", "4"], "4"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n", " ", "\[Pi]"}], "+", " ", "k2"}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["g", "2"], "+", 
          SuperscriptBox["u", "2"]}], ")"}]}]}], "]"}], "-", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       FractionBox[
        SuperscriptBox["g", "4"], "4"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], "k2", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["g", "2"], "+", 
          SuperscriptBox["u", "2"]}], ")"}]}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{"eqn2", ",", "k2"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.732648722563427*^9, 3.7326487641198225`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"k2", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "-", 
        SuperscriptBox["u", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SuperscriptBox["g", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "-", 
        SuperscriptBox["u", "2"]}], ")"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox["a", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["g", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.732648748891179*^9, 3.732648764446821*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"disp", " ", "=", " ", 
  RowBox[{"e2", " ", "==", " ", 
   RowBox[{
    FractionBox[
     SuperscriptBox["g1", "2"], "2"], "+", 
    FractionBox[
     SuperscriptBox["u", "2"], "4"], "+", 
    RowBox[{"a2", " ", "k2"}], " ", "-", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      FractionBox[
       SuperscriptBox["g1", "4"], "4"], "+", 
      RowBox[{"a2", " ", "k2", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["g1", "2"], "+", 
         SuperscriptBox["u", "2"]}], ")"}]}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{"disp", ",", "k2"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7327047958914375`*^9, 3.732704873596259*^9}, {
  3.732705101600782*^9, 3.7327051076083937`*^9}, {3.732705462643937*^9, 
  3.7327054723737574`*^9}}],

Cell[BoxData[
 RowBox[{"e2", "\[Equal]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["g1", "2"], "2"], "+", 
   RowBox[{"a2", " ", "k2"}], "+", 
   FractionBox[
    SuperscriptBox["u", "2"], "4"], "-", 
   SqrtBox[
    RowBox[{
     FractionBox[
      SuperscriptBox["g1", "4"], "4"], "+", 
     RowBox[{"a2", " ", "k2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["g1", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]}]]}]}]], "Output",
 CellChangeTimes->{3.7327054779653835`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"k2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"a2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "e2"}], "+", 
          SuperscriptBox["u", "2"]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["g1", "2"]}], " ", 
             SuperscriptBox["u", "2"]}], "+", 
            RowBox[{"4", " ", "e2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["g1", "2"], "+", 
               SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}]}]]}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["a2", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"k2", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"a2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "e2"}], "+", 
          SuperscriptBox["u", "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["a2", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              SuperscriptBox["g1", "2"]}], " ", 
             SuperscriptBox["u", "2"]}], "+", 
            RowBox[{"4", " ", "e2", " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["g1", "2"], "+", 
               SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}]}]]}]}], 
      RowBox[{"4", " ", 
       SuperscriptBox["a2", "2"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7327054780434384`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eqn1", " ", "=", 
  RowBox[{"x", " ", "==", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"en", " ", "-", " ", 
      RowBox[{"u", "/", "2"}]}], ")"}], " ", "b", " ", 
    "y"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eqn2", " ", "=", " ", 
  RowBox[{"y", " ", "==", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{"en", " ", "+", " ", 
       RowBox[{"u", "/", "2"}]}], ")"}], "g1"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"en", "-", 
         RowBox[{"u", "/", "2"}]}], ")"}], "2"], "-", 
      SuperscriptBox["b", "2"]}], ")"}], "z"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eqn3", " ", "=", 
  RowBox[{"z", " ", "==", " ", 
   RowBox[{
    FractionBox[
     RowBox[{"(", 
      RowBox[{"en", " ", "-", " ", 
       RowBox[{"u", "/", "2"}]}], ")"}], "g1"], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"en", " ", "+", " ", 
         RowBox[{"u", "/", "2"}]}], ")"}], "2"], " ", "-", 
      SuperscriptBox["b", "2"]}], ")"}], "y"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"eqn4", "  ", "=", " ", 
  RowBox[{"w", " ", "==", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"en", " ", "+", " ", 
      RowBox[{"u", "/", "2"}]}], ")"}], " ", "b", " ", 
    "z"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"{", 
     RowBox[{"eqn1", ",", "eqn2", ",", "eqn3", ",", "eqn4"}], "}"}], "]"}], 
   ",", "z"}], "]"}]}], "Input",
 CellChangeTimes->{{3.732717579561818*^9, 3.7327178040688705`*^9}}],

Cell[BoxData[
 RowBox[{"x", "\[Equal]", 
  RowBox[{"b", " ", 
   RowBox[{"(", 
    RowBox[{"en", "-", 
     FractionBox["u", "2"]}], ")"}], " ", "y"}]}]], "Output",
 CellChangeTimes->{{3.7327177933582807`*^9, 3.7327178048423705`*^9}}],

Cell[BoxData[
 RowBox[{"y", "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["b", "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"en", "-", 
         FractionBox["u", "2"]}], ")"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"en", "+", 
      FractionBox["u", "2"]}], ")"}], " ", "z"}], "g1"]}]], "Output",
 CellChangeTimes->{{3.7327177933582807`*^9, 3.7327178048423705`*^9}}],

Cell[BoxData[
 RowBox[{"z", "\[Equal]", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["b", "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"en", "+", 
         FractionBox["u", "2"]}], ")"}], "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"en", "-", 
      FractionBox["u", "2"]}], ")"}], " ", "y"}], "g1"]}]], "Output",
 CellChangeTimes->{{3.7327177933582807`*^9, 3.732717804858001*^9}}],

Cell[BoxData[
 RowBox[{"w", "\[Equal]", 
  RowBox[{"b", " ", 
   RowBox[{"(", 
    RowBox[{"en", "+", 
     FractionBox["u", "2"]}], ")"}], " ", "z"}]}]], "Output",
 CellChangeTimes->{{3.7327177933582807`*^9, 3.732717804858001*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"w", "\[Rule]", "0"}], ",", 
     RowBox[{"x", "\[Rule]", "0"}], ",", 
     RowBox[{"y", "\[Rule]", "0"}], ",", 
     RowBox[{"True", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g1", "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "8"]}], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"2", " ", "en"}], "-", "u"}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["b", "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "en"}], "+", "u"}], ")"}], "2"]}], 
          ")"}]}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["b", "2"]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], "2"]}]]}]}], ",", 
     RowBox[{"w", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "b", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"2", " ", "en"}], "-", "u"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["b", "2"]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], "2"]}]], " ", 
         "y"}], 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "4"}], " ", 
              SuperscriptBox["b", "2"]}], "+", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "en"}], "+", "u"}], ")"}], "2"]}], 
            ")"}]}]]}]]}]}], ",", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"en", " ", "y"}], "-", 
         FractionBox[
          RowBox[{"u", " ", "y"}], "2"]}], ")"}]}]}], ",", 
     RowBox[{"True", "\[Rule]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"2", " ", "en"}], "-", "u"}]], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["b", "2"]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], "2"]}]], " ", 
         "y"}], 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], " ", 
             SuperscriptBox["b", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "en"}], "+", "u"}], ")"}], "2"]}], 
           ")"}]}]]]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"g1", "\[Rule]", 
      RowBox[{
       FractionBox["1", "8"], " ", "\[ImaginaryI]", " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"2", " ", "en"}], "-", "u"}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["b", "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "en"}], "+", "u"}], ")"}], "2"]}], 
          ")"}]}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["b", "2"]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], "2"]}]]}]}], ",", 
     RowBox[{"w", "\[Rule]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "b", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"2", " ", "en"}], "-", "u"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["b", "2"]}], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], "2"]}]], " ", "y"}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], " ", 
             SuperscriptBox["b", "2"]}], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "en"}], "+", "u"}], ")"}], "2"]}], 
           ")"}]}]]}]]}], ",", 
     RowBox[{"x", "\[Rule]", 
      RowBox[{"b", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"en", " ", "y"}], "-", 
         FractionBox[
          RowBox[{"u", " ", "y"}], "2"]}], ")"}]}]}], ",", 
     RowBox[{"True", "\[Rule]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"2", " ", "en"}], "-", "u"}]], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["b", "2"]}], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], "2"]}]], " ", "y"}], 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "en"}], "+", "u"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "4"}], " ", 
            SuperscriptBox["b", "2"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "en"}], "+", "u"}], ")"}], "2"]}], 
          ")"}]}]]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "\[Rule]", 
      RowBox[{"en", "-", 
       FractionBox["u", "2"]}]}], ",", 
     RowBox[{"w", "\[Rule]", "0"}], ",", 
     RowBox[{"x", "\[Rule]", "0"}], ",", 
     RowBox[{"y", "\[Rule]", "0"}], ",", 
     RowBox[{"True", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "\[Rule]", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "en"}], "+", "u"}], ")"}]}]}], ",", 
     RowBox[{"w", "\[Rule]", "0"}], ",", 
     RowBox[{"x", "\[Rule]", "0"}], ",", 
     RowBox[{"y", "\[Rule]", "0"}], ",", 
     RowBox[{"True", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"u", "\[Rule]", 
      RowBox[{
       RowBox[{"-", "2"}], " ", "en"}]}], ",", 
     RowBox[{"w", "\[Rule]", "0"}], ",", 
     RowBox[{"x", "\[Rule]", "0"}], ",", 
     RowBox[{"y", "\[Rule]", "0"}], ",", 
     RowBox[{"True", "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7327177933582807`*^9, 3.7327178062805424`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fermi Level as function of n", "Subsubsection",
 CellChangeTimes->{{3.732883881800294*^9, 3.732883886737005*^9}}],

Cell[TextData[{
 "Letting ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["a", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "= ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     SubscriptBox["\[HBar]v", "F"], ")"}], "2"], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.7328839525681133`*^9, 3.7328839672539115`*^9}, {
  3.7328840214567857`*^9, 3.7328840215505843`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"k2", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"4", " ", 
      SuperscriptBox["a", "2"]}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{
         SuperscriptBox["\[Pi]", "2"], 
         SuperscriptBox["a", "4"], 
         SuperscriptBox["n", "2"]}], "+", 
        RowBox[{
         SuperscriptBox["g1", "2"], 
         SuperscriptBox["u", "2"]}]}], 
       RowBox[{
        SuperscriptBox["g1", "2"], "+", 
        SuperscriptBox["u", "2"]}]], "+", " ", 
      SuperscriptBox["u", "2"], " ", "+", " ", 
      RowBox[{"2", " ", "\[Pi]", " ", 
       SuperscriptBox["a", "2"], "n"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e2", " ", "=", " ", 
   RowBox[{
    FractionBox[
     SuperscriptBox["g1", "2"], "2"], "+", 
    FractionBox[
     SuperscriptBox["u", "2"], "4"], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], "k2"}], " ", "-", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        SuperscriptBox["g1", "4"], "4"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], "k2", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["g1", "2"], "+", 
          SuperscriptBox["u", "2"]}], ")"}]}]}], ")"}], 
     RowBox[{"1", "/", "2"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", "e2", "]"}]}], "Input",
 CellChangeTimes->{{3.732883924365052*^9, 3.732883944848605*^9}, {
  3.732883978099882*^9, 3.732884109598287*^9}, {3.7328842494022074`*^9, 
  3.732884253498111*^9}, {3.732884343182783*^9, 3.732884344377948*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["g1", "2"], "+", 
      SuperscriptBox["u", "2"]}], ")"}]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     SuperscriptBox["g1", "4"]}], "+", 
    RowBox[{
     SuperscriptBox["a", "4"], " ", 
     SuperscriptBox["n", "2"], " ", 
     SuperscriptBox["\[Pi]", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]", " ", 
     SuperscriptBox["u", "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["u", "4"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["u", "2"], " ", 
     SqrtBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["g1", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "+", 
         SuperscriptBox["u", "2"]}], ")"}], "2"]]}], "-", 
    RowBox[{
     SuperscriptBox["g1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["u", "2"]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["g1", "2"], "+", 
            RowBox[{
             SuperscriptBox["a", "2"], " ", "n", " ", "\[Pi]"}], "+", 
            SuperscriptBox["u", "2"]}], ")"}], "2"]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.732884111014078*^9, 3.732884256463665*^9, 
  3.7328843459339757`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solution to Charge Screening Problem", "Subsubsection",
 CellChangeTimes->{{3.732887059178125*^9, 3.7328870647716103`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"V1", " ", "=", " ", 
   RowBox[{"VT", "+", 
    RowBox[{"eF", "/", "q"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"V2", " ", "=", " ", 
   RowBox[{"VG", " ", "+", " ", 
    RowBox[{"eF", "/", "q"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", " ", "=", " ", 
   RowBox[{
    FractionBox["1", "q"], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"V1", " ", "ep1"}], "d1"], "+", 
      FractionBox[
       RowBox[{"V2", " ", "ep2"}], "d2"]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", " ", "=", " ", 
   RowBox[{
    RowBox[{"-", "q"}], " ", 
    FractionBox["d", "2"], 
    RowBox[{"(", 
     RowBox[{
      FractionBox["V2", "d2"], "-", 
      FractionBox["V1", "d1"]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqn", " ", "=", " ", 
   RowBox[{
    SuperscriptBox["eF", "2"], " ", "\[Equal]", " ", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["a", "4"], 
       SuperscriptBox["\[Pi]", "2"], 
       SuperscriptBox["n", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["g1", "2"], 
       SuperscriptBox["u", "2"]}]}], 
     RowBox[{"4", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["g1", "2"], "+", 
        SuperscriptBox["u", "2"]}], ")"}]}]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{"eqn", ",", "eF"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7328870972489734`*^9, 3.7328871050484095`*^9}, {
  3.732889565340489*^9, 3.732889665376462*^9}, {3.732889763580535*^9, 
  3.7328898591929045`*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.732889841807787*^9, 3.732889951909795*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{641, 697},
WindowMargins->{{Automatic, -17}, {2, Automatic}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (July 28, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1160, 35, 79, "Input"],
Cell[1743, 59, 863, 29, 71, "Output"],
Cell[2609, 90, 813, 25, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3459, 120, 1099, 34, 79, "Input"],
Cell[4561, 156, 811, 25, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5409, 186, 847, 24, 79, "Input"],
Cell[6259, 212, 513, 17, 71, "Output"],
Cell[6775, 231, 1737, 55, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8549, 291, 1594, 49, 169, "Input"],
Cell[10146, 342, 234, 6, 51, "Output"],
Cell[10383, 350, 476, 15, 69, "Output"],
Cell[10862, 367, 474, 15, 69, "Output"],
Cell[11339, 384, 232, 6, 51, "Output"],
Cell[11574, 392, 7881, 251, 571, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19492, 648, 119, 1, 39, "Subsubsection"],
Cell[19614, 651, 442, 15, 34, "Text"],
Cell[CellGroupData[{
Cell[20081, 670, 1605, 49, 137, "Input"],
Cell[21689, 721, 1610, 51, 115, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23348, 778, 129, 1, 39, "Subsubsection"],
Cell[CellGroupData[{
Cell[23502, 783, 1641, 53, 220, "Input"],
Cell[25146, 838, 99, 1, 63, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

